%ifndef SYSCALLS_INC
%define SYSCALLS_INC

; source: https://filippo.io/linux-syscall-table/
	SYSCALL_READ                    equ 0
	SYSCALL_WRITE                   equ 1
	SYSCALL_OPEN                    equ 2
	SYSCALL_CLOSE                   equ 3
	SYSCALL_STAT                    equ 4
	SYSCALL_FSTAT                   equ 5
	SYSCALL_LSTAT                   equ 6
	SYSCALL_POLL                    equ 7
	SYSCALL_LSEEK                   equ 8
	SYSCALL_MMAP                    equ 9
	SYSCALL_MPROTECT                equ 10
	SYSCALL_MUNMAP                  equ 11
	SYSCALL_BRK                     equ 12
	SYSCALL_RT_SIGACTION            equ 13
	SYSCALL_RT_SIGPROCMASK          equ 14
	SYSCALL_RT_SIGRETURN            equ 15
	SYSCALL_IOCTL                   equ 16
	SYSCALL_PREAD64                 equ 17
	SYSCALL_PWRITE64                equ 18
	SYSCALL_READV                   equ 19
	SYSCALL_WRITEV                  equ 20
	SYSCALL_ACCESS                  equ 21
	SYSCALL_PIPE                    equ 22
	SYSCALL_SELECT                  equ 23
	SYSCALL_SCHED_YIELD             equ 24
	SYSCALL_MREMAP                  equ 25
	SYSCALL_MSYNC                   equ 26
	SYSCALL_MINCORE                 equ 27
	SYSCALL_MADVISE                 equ 28
	SYSCALL_SHMGET                  equ 29
	SYSCALL_SHMAT                   equ 30
	SYSCALL_SHMCTL                  equ 31
	SYSCALL_DUP                     equ 32
	SYSCALL_DUP2                    equ 33
	SYSCALL_PAUSE                   equ 34
	SYSCALL_NANOSLEEP               equ 35
	SYSCALL_GETITIMER               equ 36
	SYSCALL_ALARM                   equ 37
	SYSCALL_SETITIMER               equ 38
	SYSCALL_GETPID                  equ 39
	SYSCALL_SENDFILE                equ 40
	SYSCALL_SOCKET                  equ 41
	SYSCALL_CONNECT                 equ 42
	SYSCALL_ACCEPT                  equ 43
	SYSCALL_SENDTO                  equ 44
	SYSCALL_RECVFROM                equ 45
	SYSCALL_SENDMSG                 equ 46
	SYSCALL_RECVMSG                 equ 47
	SYSCALL_SHUTDOWN                equ 48
	SYSCALL_BIND                    equ 49
	SYSCALL_LISTEN                  equ 50
	SYSCALL_GETSOCKNAME             equ 51
	SYSCALL_GETPEERNAME             equ 52
	SYSCALL_SOCKETPAIR              equ 53
	SYSCALL_SETSOCKOPT              equ 54
	SYSCALL_GETSOCKOPT              equ 55
	SYSCALL_CLONE                   equ 56
	SYSCALL_FORK                    equ 57
	SYSCALL_VFORK                   equ 58
	SYSCALL_EXECVE                  equ 59
	SYSCALL_EXIT                    equ 60
	SYSCALL_WAIT4                   equ 61
	SYSCALL_KILL                    equ 62
	SYSCALL_UNAME                   equ 63
	SYSCALL_SEMGET                  equ 64
	SYSCALL_SEMOP                   equ 65
	SYSCALL_SEMCTL                  equ 66
	SYSCALL_SHMDT                   equ 67
	SYSCALL_MSGGET                  equ 68
	SYSCALL_MSGSND                  equ 69
	SYSCALL_MSGRCV                  equ 70
	SYSCALL_MSGCTL                  equ 71
	SYSCALL_FCNTL                   equ 72
	SYSCALL_FLOCK                   equ 73
	SYSCALL_FSYNC                   equ 74
	SYSCALL_FDATASYNC               equ 75
	SYSCALL_TRUNCATE                equ 76
	SYSCALL_FTRUNCATE               equ 77
	SYSCALL_GETDENTS                equ 78
	SYSCALL_GETCWD                  equ 79
	SYSCALL_CHDIR                   equ 80
	SYSCALL_FCHDIR                  equ 81
	SYSCALL_RENAME                  equ 82
	SYSCALL_MKDIR                   equ 83
	SYSCALL_RMDIR                   equ 84
	SYSCALL_CREAT                   equ 85
	SYSCALL_LINK                    equ 86
	SYSCALL_UNLINK                  equ 87
	SYSCALL_SYMLINK                 equ 88
	SYSCALL_READLINK                equ 89
	SYSCALL_CHMOD                   equ 90
	SYSCALL_FCHMOD                  equ 91
	SYSCALL_CHOWN                   equ 92
	SYSCALL_FCHOWN                  equ 93
	SYSCALL_LCHOWN                  equ 94
	SYSCALL_UMASK                   equ 95
	SYSCALL_GETTIMEOFDAY            equ 96
	SYSCALL_GETRLIMIT               equ 97
	SYSCALL_GETRUSAGE               equ 98
	SYSCALL_SYSINFO                 equ 99
	SYSCALL_TIMES                   equ 100
	SYSCALL_PTRACE                  equ 101
	SYSCALL_GETUID                  equ 102
	SYSCALL_SYSLOG                  equ 103
	SYSCALL_GETGID                  equ 104
	SYSCALL_SETUID                  equ 105
	SYSCALL_SETGID                  equ 106
	SYSCALL_GETEUID                 equ 107
	SYSCALL_GETEGID                 equ 108
	SYSCALL_SETPGID                 equ 109
	SYSCALL_GETPPID                 equ 110
	SYSCALL_GETPGRP                 equ 111
	SYSCALL_SETSID                  equ 112
	SYSCALL_SETREUID                equ 113
	SYSCALL_SETREGID                equ 114
	SYSCALL_GETGROUPS               equ 115
	SYSCALL_SETGROUPS               equ 116
	SYSCALL_SETRESUID               equ 117
	SYSCALL_GETRESUID               equ 118
	SYSCALL_SETRESGID               equ 119
	SYSCALL_GETRESGID               equ 120
	SYSCALL_GETPGID                 equ 121
	SYSCALL_SETFSUID                equ 122
	SYSCALL_SETFSGID                equ 123
	SYSCALL_GETSID                  equ 124
	SYSCALL_CAPGET                  equ 125
	SYSCALL_CAPSET                  equ 126
	SYSCALL_RT_SIGPENDING           equ 127
	SYSCALL_RT_SIGTIMEDWAIT         equ 128
	SYSCALL_RT_SIGQUEUEINFO         equ 129
	SYSCALL_RT_SIGSUSPEND           equ 130
	SYSCALL_SIGALTSTACK             equ 131
	SYSCALL_UTIME                   equ 132
	SYSCALL_MKNOD                   equ 133
	SYSCALL_USELIB                  equ 134
	SYSCALL_PERSONALITY             equ 135
	SYSCALL_USTAT                   equ 136
	SYSCALL_STATFS                  equ 137
	SYSCALL_FSTATFS                 equ 138
	SYSCALL_SYSFS                   equ 139
	SYSCALL_GETPRIORITY             equ 140
	SYSCALL_SETPRIORITY             equ 141
	SYSCALL_SCHED_SETPARAM          equ 142
	SYSCALL_SCHED_GETPARAM          equ 143
	SYSCALL_SCHED_SETSCHEDULER      equ 144
	SYSCALL_SCHED_GETSCHEDULER      equ 145
	SYSCALL_SCHED_GET_PRIORITY_MAX  equ 146
	SYSCALL_SCHED_GET_PRIORITY_MIN  equ 147
	SYSCALL_SCHED_RR_GET_INTERVAL   equ 148
	SYSCALL_MLOCK                   equ 149
	SYSCALL_MUNLOCK                 equ 150
	SYSCALL_MLOCKALL                equ 151
	SYSCALL_MUNLOCKALL              equ 152
	SYSCALL_VHANGUP                 equ 153
	SYSCALL_MODIFY_LDT              equ 154
	SYSCALL_PIVOT_ROOT              equ 155
	SYSCALL__SYSCTL                 equ 156
	SYSCALL_PRCTL                   equ 157
	SYSCALL_ARCH_PRCTL              equ 158
	SYSCALL_ADJTIMEX                equ 159
	SYSCALL_SETRLIMIT               equ 160
	SYSCALL_CHROOT                  equ 161
	SYSCALL_SYNC                    equ 162
	SYSCALL_ACCT                    equ 163
	SYSCALL_SETTIMEOFDAY            equ 164
	SYSCALL_MOUNT                   equ 165
	SYSCALL_UMOUNT2                 equ 166
	SYSCALL_SWAPON                  equ 167
	SYSCALL_SWAPOFF                 equ 168
	SYSCALL_REBOOT                  equ 169
	SYSCALL_SETHOSTNAME             equ 170
	SYSCALL_SETDOMAINNAME           equ 171
	SYSCALL_IOPL                    equ 172
	SYSCALL_IOPERM                  equ 173
	SYSCALL_CREATE_MODULE           equ 174
	SYSCALL_INIT_MODULE             equ 175
	SYSCALL_DELETE_MODULE           equ 176
	SYSCALL_GET_KERNEL_SYMS         equ 177
	SYSCALL_QUERY_MODULE            equ 178
	SYSCALL_QUOTACTL                equ 179
	SYSCALL_NFSSERVCTL              equ 180
	SYSCALL_GETPMSG                 equ 181
	SYSCALL_PUTPMSG                 equ 182
	SYSCALL_AFS_SYSCALL             equ 183
	SYSCALL_TUXCALL                 equ 184
	SYSCALL_SECURITY                equ 185
	SYSCALL_GETTID                  equ 186
	SYSCALL_READAHEAD               equ 187
	SYSCALL_SETXATTR                equ 188
	SYSCALL_LSETXATTR               equ 189
	SYSCALL_FSETXATTR               equ 190
	SYSCALL_GETXATTR                equ 191
	SYSCALL_LGETXATTR               equ 192
	SYSCALL_FGETXATTR               equ 193
	SYSCALL_LISTXATTR               equ 194
	SYSCALL_LLISTXATTR              equ 195
	SYSCALL_FLISTXATTR              equ 196
	SYSCALL_REMOVEXATTR             equ 197
	SYSCALL_LREMOVEXATTR            equ 198
	SYSCALL_FREMOVEXATTR            equ 199
	SYSCALL_TKILL                   equ 200
	SYSCALL_TIME                    equ 201
	SYSCALL_FUTEX                   equ 202
	SYSCALL_SCHED_SETAFFINITY       equ 203
	SYSCALL_SCHED_GETAFFINITY       equ 204
	SYSCALL_SET_THREAD_AREA         equ 205
	SYSCALL_IO_SETUP                equ 206
	SYSCALL_IO_DESTROY              equ 207
	SYSCALL_IO_GETEVENTS            equ 208
	SYSCALL_IO_SUBMIT               equ 209
	SYSCALL_IO_CANCEL               equ 210
	SYSCALL_GET_THREAD_AREA         equ 211
	SYSCALL_LOOKUP_DCOOKIE          equ 212
	SYSCALL_EPOLL_CREATE            equ 213
	SYSCALL_EPOLL_CTL_OLD           equ 214
	SYSCALL_EPOLL_WAIT_OLD          equ 215
	SYSCALL_REMAP_FILE_PAGES        equ 216
	SYSCALL_GETDENTS64              equ 217
	SYSCALL_SET_TID_ADDRESS         equ 218
	SYSCALL_RESTART_SYSCALL         equ 219
	SYSCALL_SEMTIMEDOP              equ 220
	SYSCALL_FADVISE64               equ 221
	SYSCALL_TIMER_CREATE            equ 222
	SYSCALL_TIMER_SETTIME           equ 223
	SYSCALL_TIMER_GETTIME           equ 224
	SYSCALL_TIMER_GETOVERRUN        equ 225
	SYSCALL_TIMER_DELETE            equ 226
	SYSCALL_CLOCK_SETTIME           equ 227
	SYSCALL_CLOCK_GETTIME           equ 228
	SYSCALL_CLOCK_GETRES            equ 229
	SYSCALL_CLOCK_NANOSLEEP         equ 230
	SYSCALL_EXIT_GROUP              equ 231
	SYSCALL_EPOLL_WAIT              equ 232
	SYSCALL_EPOLL_CTL               equ 233
	SYSCALL_TGKILL                  equ 234
	SYSCALL_UTIMES                  equ 235
	SYSCALL_VSERVER                 equ 236
	SYSCALL_MBIND                   equ 237
	SYSCALL_SET_MEMPOLICY           equ 238
	SYSCALL_GET_MEMPOLICY           equ 239
	SYSCALL_MQ_OPEN                 equ 240
	SYSCALL_MQ_UNLINK               equ 241
	SYSCALL_MQ_TIMEDSEND            equ 242
	SYSCALL_MQ_TIMEDRECEIVE         equ 243
	SYSCALL_MQ_NOTIFY               equ 244
	SYSCALL_MQ_GETSETATTR           equ 245
	SYSCALL_KEXEC_LOAD              equ 246
	SYSCALL_WAITID                  equ 247
	SYSCALL_ADD_KEY                 equ 248
	SYSCALL_REQUEST_KEY             equ 249
	SYSCALL_KEYCTL                  equ 250
	SYSCALL_IOPRIO_SET              equ 251
	SYSCALL_IOPRIO_GET              equ 252
	SYSCALL_INOTIFY_INIT            equ 253
	SYSCALL_INOTIFY_ADD_WATCH       equ 254
	SYSCALL_INOTIFY_RM_WATCH        equ 255
	SYSCALL_MIGRATE_PAGES           equ 256
	SYSCALL_OPENAT                  equ 257
	SYSCALL_MKDIRAT                 equ 258
	SYSCALL_MKNODAT                 equ 259
	SYSCALL_FCHOWNAT                equ 260
	SYSCALL_FUTIMESAT               equ 261
	SYSCALL_NEWFSTATAT              equ 262
	SYSCALL_UNLINKAT                equ 263
	SYSCALL_RENAMEAT                equ 264
	SYSCALL_LINKAT                  equ 265
	SYSCALL_SYMLINKAT               equ 266
	SYSCALL_READLINKAT              equ 267
	SYSCALL_FCHMODAT                equ 268
	SYSCALL_FACCESSAT               equ 269
	SYSCALL_PSELECT6                equ 270
	SYSCALL_PPOLL                   equ 271
	SYSCALL_UNSHARE                 equ 272
	SYSCALL_SET_ROBUST_LIST         equ 273
	SYSCALL_GET_ROBUST_LIST         equ 274
	SYSCALL_SPLICE                  equ 275
	SYSCALL_TEE                     equ 276
	SYSCALL_SYNC_FILE_RANGE         equ 277
	SYSCALL_VMSPLICE                equ 278
	SYSCALL_MOVE_PAGES              equ 279
	SYSCALL_UTIMENSAT               equ 280
	SYSCALL_EPOLL_PWAIT             equ 281
	SYSCALL_SIGNALFD                equ 282
	SYSCALL_TIMERFD_CREATE          equ 283
	SYSCALL_EVENTFD                 equ 284
	SYSCALL_FALLOCATE               equ 285
	SYSCALL_TIMERFD_SETTIME         equ 286
	SYSCALL_TIMERFD_GETTIME         equ 287
	SYSCALL_ACCEPT4                 equ 288
	SYSCALL_SIGNALFD4               equ 289
	SYSCALL_EVENTFD2                equ 290
	SYSCALL_EPOLL_CREATE1           equ 291
	SYSCALL_DUP3                    equ 292
	SYSCALL_PIPE2                   equ 293
	SYSCALL_INOTIFY_INIT1           equ 294
	SYSCALL_PREADV                  equ 295
	SYSCALL_PWRITEV                 equ 296
	SYSCALL_RT_TGSIGQUEUEINFO       equ 297
	SYSCALL_PERF_EVENT_OPEN         equ 298
	SYSCALL_RECVMMSG                equ 299
	SYSCALL_FANOTIFY_INIT           equ 300
	SYSCALL_FANOTIFY_MARK           equ 301
	SYSCALL_PRLIMIT64               equ 302
	SYSCALL_NAME_TO_HANDLE_AT       equ 303
	SYSCALL_OPEN_BY_HANDLE_AT       equ 304
	SYSCALL_CLOCK_ADJTIME           equ 305
	SYSCALL_SYNCFS                  equ 306
	SYSCALL_SENDMMSG                equ 307
	SYSCALL_SETNS                   equ 308
	SYSCALL_GETCPU                  equ 309
	SYSCALL_PROCESS_VM_READV        equ 310
	SYSCALL_PROCESS_VM_WRITEV       equ 311
	SYSCALL_KCMP                    equ 312
	SYSCALL_FINIT_MODULE            equ 313
	SYSCALL_SCHED_SETATTR           equ 314
	SYSCALL_SCHED_GETATTR           equ 315
	SYSCALL_RENAMEAT2               equ 316
	SYSCALL_SECCOMP                 equ 317
	SYSCALL_GETRANDOM               equ 318
	SYSCALL_MEMFD_CREATE            equ 319
	SYSCALL_KEXEC_FILE_LOAD         equ 320
	SYSCALL_BPF                     equ 321
	SYSCALL_EXECVEAT                equ 322
	SYSCALL_USERFAULTFD             equ 323
	SYSCALL_MEMBARRIER              equ 324
	SYSCALL_MLOCK2                  equ 325
	SYSCALL_COPY_FILE_RANGE         equ 326
	SYSCALL_PREADV2                 equ 327
	SYSCALL_PWRITEV2                equ 328
	SYSCALL_PKEY_MPROTECT           equ 329
	SYSCALL_PKEY_ALLOC              equ 330
	SYSCALL_PKEY_FREE               equ 331
	SYSCALL_STATX                   equ 332
	SYSCALL_IO_PGETEVENTS           equ 333
	SYSCALL_RSEQ                    equ 334
	SYSCALL_URETPROBE               equ 335
	SYSCALL_PIDFD_SEND_SIGNAL       equ 424
	SYSCALL_IO_URING_SETUP          equ 425
	SYSCALL_IO_URING_ENTER          equ 426
	SYSCALL_IO_URING_REGISTER       equ 427
	SYSCALL_OPEN_TREE               equ 428
	SYSCALL_MOVE_MOUNT              equ 429
	SYSCALL_FSOPEN                  equ 430
	SYSCALL_FSCONFIG                equ 431
	SYSCALL_FSMOUNT                 equ 432
	SYSCALL_FSPICK                  equ 433
	SYSCALL_PIDFD_OPEN              equ 434
	SYSCALL_CLONE3                  equ 435
	SYSCALL_CLOSE_RANGE             equ 436
	SYSCALL_OPENAT2                 equ 437
	SYSCALL_PIDFD_GETFD             equ 438
	SYSCALL_FACCESSAT2              equ 439
	SYSCALL_PROCESS_MADVISE         equ 440
	SYSCALL_EPOLL_PWAIT2            equ 441
	SYSCALL_MOUNT_SETATTR           equ 442
	SYSCALL_QUOTACTL_FD             equ 443
	SYSCALL_LANDLOCK_CREATE_RULESET equ 444
	SYSCALL_LANDLOCK_ADD_RULE       equ 445
	SYSCALL_LANDLOCK_RESTRICT_SELF  equ 446
	SYSCALL_MEMFD_SECRET            equ 447
	SYSCALL_PROCESS_MRELEASE        equ 448
	SYSCALL_FUTEX_WAITV             equ 449
	SYSCALL_SET_MEMPOLICY_HOME_NODE equ 450
	SYSCALL_CACHESTAT               equ 451
	SYSCALL_FCHMODAT2               equ 452
	SYSCALL_MAP_SHADOW_STACK        equ 453
	SYSCALL_FUTEX_WAKE              equ 454
	SYSCALL_FUTEX_WAIT              equ 455
	SYSCALL_FUTEX_REQUEUE           equ 456
	SYSCALL_STATMOUNT               equ 457
	SYSCALL_LISTMOUNT               equ 458
	SYSCALL_LSM_GET_SELF_ATTR       equ 459
	SYSCALL_LSM_SET_SELF_ATTR       equ 460
	SYSCALL_LSM_LIST_MODULES        equ 461
	SYSCALL_MSEAL                   equ 462
	SYSCALL_SETXATTRAT              equ 463
	SYSCALL_GETXATTRAT              equ 464
	SYSCALL_LISTXATTRAT             equ 465
	SYSCALL_REMOVEXATTRAT           equ 466
	SYSCALL_OPEN_TREE_ATTR          equ 467

%macro sys_call 1-7
    mov rax, %1
    %if %0 > 1
        mov rdi, %2
    %endif
    %if %0 > 2
        mov rsi, %3
    %endif
    %if %0 > 3
        mov rdx, %4
    %endif
    %if %0 > 4
        mov r10, %5
    %endif
    %if %0 > 5
        mov r8, %6
    %endif
    %if %0 > 6
        mov r9, %7
    %endif
    syscall
%endmacro

%define sys_read(fd,   str, n) sys_call SYSCALL_READ, fd, str, n
%define sys_write(fd,  str, n) sys_call SYSCALL_WRITE, fd, str, n
%define sys_open(path, flag, mode) sys_call SYSCALL_OPEN, path, flag, mode
%define sys_close(fd)  sys_call SYSCALL_CLOSE, fd
%define sys_stat(path, stat_ptr) sys_call SYSCALL_STAT, path, stat_ptr
%define sys_exit(code) sys_call SYSCALL_EXIT, code

%endif ; SYSCALLS_INC
